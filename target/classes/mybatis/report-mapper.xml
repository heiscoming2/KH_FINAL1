<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Report">
	
	<resultMap type="ReportDto" id="ReportMap">
		<result property="report_no" column="REPORT_NO"/>
		<result property="m_no" column="M_NO"/>
		<result property="bd_no" column="BD_NO"/>
		<result property="report_board" column="REPORT_BOARD"/>
		<result property="report_reason" column="REPORT_REASON"/>
		<result property="report_date" column="REPORT_DATE"/>
		<result property="report_sum" column="REPORT_SUM"/> 
	</resultMap>

	
	<select id="selectList" resultMap="ReportMap">
        SELECT *
        FROM REPORT A
        JOIN IT_MEMBER B
        ON A.M_NO=B.M_NO
        JOIN BOARD C
        ON A.BD_NO=C.BD_NO
        ORDER BY REPORT_NO DESC
	</select>
	
	<select id="selectOne" resultType="ReportDto" parameterType="int">
		SELECT *
        FROM REPORT A
        JOIN IT_MEMBER B
        ON A.M_NO=B.M_NO
        JOIN BOARD C
        ON A.BD_NO=C.BD_NO
        ORDER BY REPORT_NO DESC
		WHERE A.REPORT_NO=#{report_no}
	</select>
	
	<select id="insert" parameterType="ReportDto">
		INSERT INTO REPORT
		VALUES(REPORT_SEQ.NEXTVAL, #{m_no}, #{bd_no}, #{report_board} , #{report_reason}, SYSDATE, 1)
	</select>
	
	<select id="count" resultType="ReportDto" parameterType="int">
		SELECT REPORT_BOARD, COUNT(*) CNT
		FROM REPORT
		GROUP BY REPORT_BOARD
	</select>
	
	<update id="update" parameterType="ManageMemberDto">
		UPDATE IT_MEMBER
		SET M_ACT=#{m_act}, M_AUTH=#{m_auth}, M_ADMIN_CERT=#{m_admin_cert}
		WHERE M_NO=#{m_no}
	</update>
	
	
	
</mapper>